var H=Symbol("Comlink.proxy"),J=Symbol("Comlink.endpoint"),K=Symbol("Comlink.releaseProxy"),L=Symbol("Comlink.finalizer"),k=Symbol("Comlink.thrown"),_=t=>typeof t=="object"&&t!==null||typeof t=="function",Q={canHandle:t=>_(t)&&t[H],serialize(t){let{port1:e,port2:n}=new MessageChannel;return U(t,e),[n,[n]]},deserialize(t){return t.start(),D(t)}},Z={canHandle:t=>_(t)&&k in t,serialize({value:t}){let e;return t instanceof Error?e={isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:e={isError:!1,value:t},[e,[]]},deserialize(t){throw t.isError?Object.assign(new Error(t.value.message),t.value):t.value}},j=new Map([["proxy",Q],["throw",Z]]);function tt(t,e){for(let n of t)if(e===n||n==="*"||n instanceof RegExp&&n.test(e))return!0;return!1}function U(t,e=globalThis,n=["*"]){e.addEventListener("message",function i(o){if(!o||!o.data)return;if(!tt(n,o.origin)){console.warn(`Invalid origin '${o.origin}' for comlink proxy`);return}let{id:a,type:r,path:s}=Object.assign({path:[]},o.data),l=(o.data.argumentList||[]).map(v),c;try{let u=s.slice(0,-1).reduce((d,y)=>d[y],t),h=s.reduce((d,y)=>d[y],t);switch(r){case"GET":c=h;break;case"SET":u[s.slice(-1)[0]]=v(o.data.value),c=!0;break;case"APPLY":c=h.apply(u,l);break;case"CONSTRUCT":{let d=new h(...l);c=rt(d)}break;case"ENDPOINT":{let{port1:d,port2:y}=new MessageChannel;U(t,y),c=at(d,[d])}break;case"RELEASE":c=void 0;break;default:return}}catch(u){c={value:u,[k]:0}}Promise.resolve(c).catch(u=>({value:u,[k]:0})).then(u=>{let[h,d]=A(u);e.postMessage(Object.assign(Object.assign({},h),{id:a}),d),r==="RELEASE"&&(e.removeEventListener("message",i),W(e),L in t&&typeof t[L]=="function"&&t[L]())}).catch(u=>{let[h,d]=A({value:new TypeError("Unserializable return value"),[k]:0});e.postMessage(Object.assign(Object.assign({},h),{id:a}),d)})}),e.start&&e.start()}function et(t){return t.constructor.name==="MessagePort"}function W(t){et(t)&&t.close()}function D(t,e){return N(t,[],e)}function R(t){if(t)throw new Error("Proxy has been released and is not useable")}function Y(t){return b(t,{type:"RELEASE"}).then(()=>{W(t)})}var M=new WeakMap,S="FinalizationRegistry"in globalThis&&new FinalizationRegistry(t=>{let e=(M.get(t)||0)-1;M.set(t,e),e===0&&Y(t)});function nt(t,e){let n=(M.get(e)||0)+1;M.set(e,n),S&&S.register(t,e,t)}function ot(t){S&&S.unregister(t)}function N(t,e=[],n=function(){}){let i=!1,o=new Proxy(n,{get(a,r){if(R(i),r===K)return()=>{ot(o),Y(t),i=!0};if(r==="then"){if(e.length===0)return{then:()=>o};let s=b(t,{type:"GET",path:e.map(l=>l.toString())}).then(v);return s.then.bind(s)}return N(t,[...e,r])},set(a,r,s){R(i);let[l,c]=A(s);return b(t,{type:"SET",path:[...e,r].map(u=>u.toString()),value:l},c).then(v)},apply(a,r,s){R(i);let l=e[e.length-1];if(l===J)return b(t,{type:"ENDPOINT"}).then(v);if(l==="bind")return N(t,e.slice(0,-1));let[c,u]=O(s);return b(t,{type:"APPLY",path:e.map(h=>h.toString()),argumentList:c},u).then(v)},construct(a,r){R(i);let[s,l]=O(r);return b(t,{type:"CONSTRUCT",path:e.map(c=>c.toString()),argumentList:s},l).then(v)}});return nt(o,t),o}function it(t){return Array.prototype.concat.apply([],t)}function O(t){let e=t.map(A);return[e.map(n=>n[0]),it(e.map(n=>n[1]))]}var B=new WeakMap;function at(t,e){return B.set(t,e),t}function rt(t){return Object.assign(t,{[H]:!0})}function A(t){for(let[e,n]of j)if(n.canHandle(t)){let[i,o]=n.serialize(t);return[{type:"HANDLER",name:e,value:i},o]}return[{type:"RAW",value:t},B.get(t)||[]]}function v(t){switch(t.type){case"HANDLER":return j.get(t.name).deserialize(t.value);case"RAW":return t.value}}function b(t,e,n){return new Promise(i=>{let o=st();t.addEventListener("message",function a(r){!r.data||!r.data.id||r.data.id!==o||(t.removeEventListener("message",a),i(r.data))}),t.start&&t.start(),t.postMessage(Object.assign({id:o},e),n)})}function st(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}var ct=D(new Worker(new URL("./wrk/ffs.js",self.location))),X=(t,e,n)=>ct.findSolution(t,e,n);var I=class{constructor(e=document.body){this.container=e,this.controllers=[],this.hidden=!1}addSlider(e,n,i,o=0,a=100,r=1){let s=this._createUIItem(e),l=document.createElement("input");l.className="slider",l.type="range",l.min=o,l.max=a,l.step=r,l.value=n[i];let c=document.createElement("span");c.textContent=l.value,l.oninput=()=>{n[i]=parseFloat(l.value),c.textContent=l.value},s.appendChild(l),s.appendChild(c),this.container.appendChild(s)}addCheckbox(e,n,i){let o=this._createUIItem(e),a=document.createElement("input");a.type="checkbox",a.checked=n[i],a.onchange=()=>{n[i]=a.checked},o.appendChild(a),this.container.appendChild(o)}addDropdown(e,n,i,o){let a=this._createUIItem(e),r=document.createElement("select");for(let[s,l]of Object.entries(o)){let c=document.createElement("option");c.value=l,c.textContent=s,r.appendChild(c)}r.value=n[i],r.onchange=()=>{n[i]=parseFloat(r.value)},a.appendChild(r),this.container.appendChild(a)}addButton(e,n){let i=this._createUIItem(""),o=document.createElement("button");o.textContent=e,o.className="neumorphic-button",o.onclick=n,i.appendChild(o),this.container.appendChild(i)}addInfo(e,n){let i=this._createUIItem(e),o=document.createElement("div");o.className="info",o.textContent=n,i.appendChild(o),this.container.appendChild(i)}toggleMenu(){this.hidden=!this.hidden,this.container.classList.toggle("hidden",this.hidden)}_createUIItem(e){let n=document.createElement("div");if(n.className="ui-item",e){let i=document.createElement("label");i.textContent=e,n.appendChild(i)}return n}};function lt(t){ut(),f(1,1),f(4,5),f(3,4),f(4,3),f(3,2),f(2,1),f(2,3),f(3,5),f(1,2),pt(t)}var $=[],dt=0,T=[];function ut(){let t=document.createElement("input");t.type="file",t.accept="image/*",t.multiple=!0;let e=document.createElement("div");e.innerText="+",e.style.position="absolute",e.style.cursor="pointer",e.style.left="5vw",e.style.top="5vh",e.style.fontSize="4em",document.body.append(e),e.onclick=()=>t.click(),t.onchange=ht}var x=document.createElement("div");x.style.display="flex";x.style.flexWrap="wrap";x.style.marginTop="15vh";document.body.appendChild(x);function ht(t){document.getElementById("uiContainer").style.display="none";let e=t.target.files;Array.from(e).forEach(n=>{let i=new FileReader;i.onload=function(o){let a=document.createElement("img");a.src=o.target.result,a.style.maxWidth="33vw",a.style.maxHeight="33vh",a.style.objectFit="cover",x.appendChild(a),a.onload=r=>{$.push(a),T.push({width:r.target.naturalWidth,height:r.target.naturalHeight,url:dt+++""})}},i.readAsDataURL(n)})}function f(t,e){let n=t/e,i=document.createElement("div");i.className="card-container";let o=document.createElement("div");o.style.backgroundColor="hsl(0, 0%, 90%)",n<=1?(o.style.width="50px",o.style.height=50/n+"px"):(o.style.height="50px",o.style.width=50*n+"px");let a=0,r=document.createElement("p");r.innerText=`${t}:${e}`,o.append(r);let s=document.createElement("p");s.innerHTML=`amount: <span class='span-amount'> ${a} </span>`,s.style.fontSize="1em",i.append(s),i.append(o),i.addEventListener("click",()=>{a++,s.innerHTML=`amount: <span class='span-amount'> ${a} </span>`,T.push({width:t,height:e,url:""})}),q.append(i)}function pt(t){let e=document.createElement("div");e.innerText="run",e.style.position="absolute",e.style.cursor="pointer",e.style.right="10vw",e.style.top="5vh",e.style.fontSize="4em",e.addEventListener("click",()=>{T[0]!==void 0&&(document.querySelector(".menu-wraper").style.display="none",document.body.innerHTML="",t($,T))}),document.body.append(e)}function mt(t){let e=document.createElement("div");return e.innerText="next",e.style.position="absolute",e.style.cursor="pointer",e.style.right="5vw",e.style.top="5vh",e.style.fontSize="4em",e}function G(t,e){let n=2,i=1,o=document.createElement("div"),a=document.createElement("input");a.className="inputAR",a.value=n,a.oninput=s=>{n=s.target.value};let r=document.createElement("input");r.className="inputAR",r.value=i,r.oninput=s=>{i=s.target.value},button=mt(e),button.addEventListener("click",()=>{o.innerHTML="",t.CONTAINER_AR=i/n,lt(e)}),o.append(a,r,button),q.append(o)}var q=document.querySelector(".menu-container");function gt(t){for(let e=t.length-1;e>0;e--){let n=Math.floor(Math.random()*(e+1));[t[e],t[n]]=[t[n],t[e]]}}function ft(t,e,n){return{dimension:{width:t,height:e},aspectRatio:t/e,url:n}}var F={CONTAINER_AR:0};G(F,yt);new I(document.getElementById("uiContainer"));function yt(t,e){let n=document.createElement("canvas");n.onclick=()=>{z(a,r)},document.body.append(n);let i=10,o=10,a=0,r=0,s={width:0,height:0},l=[],c=n.getContext("2d"),u=t,h=e.map(m=>ft(m.width,m.height,m.url)).sort((m,w)=>m.aspectRatio-w.aspectRatio),d={width:0,height:0};function y(){n.width=window.innerWidth,n.height=window.innerHeight,s.width=n.width-i*2,s.height=s.width*F.CONTAINER_AR,s.height>n.height-o*2&&(s.height=n.height-o*2,s.width=s.height/F.CONTAINER_AR),a=(n.width-s.width)/2,r=(n.height-s.height)/2;let m=s.width/d.width,w=s.height/d.height;d.width!==0&&d.height!==0&&(l=l.map(g=>({...g,position:{x:g.position.x*m,y:g.position.y*w},dimension:{width:g.dimension.width*m,height:g.dimension.height*w}}))),d={...s},P(l)}function z(m,w){gt(h),X(h,s,{randomizeThreshold:1}).then(g=>{l=g.pictures.sort((E,C)=>E.dimension.width/E.dimension.height-C.dimension.width/C.dimension.height),P(l)})}function P(m){let w=0,g=0,E=h[0].aspectRatio,C=E;c.clearRect(0,0,n.width,n.height),c.beginPath(),c.strokeStyle="black",c.strokeRect(Math.round(a),Math.round(r),Math.round(s.width),Math.round(s.height));for(let p of m){if(c.beginPath(),E=h[w].aspectRatio,E!==C&&(g++,C=E),p.url==="")c.fillStyle="black",c.fillRect(Math.round(p.position.x+a),Math.round(p.position.y+r),Math.round(p.dimension.width),Math.round(p.dimension.height)),c.strokeStyle="white",c.lineWidth=1,c.strokeRect(Math.round(p.position.x+a),Math.round(p.position.y+r),Math.round(p.dimension.width),Math.round(p.dimension.height));else{let V=u[parseInt(p.url)];c.drawImage(V,Math.round(p.position.x+a),Math.round(p.position.y+r),Math.round(p.dimension.width),Math.round(p.dimension.height))}w++}}window.addEventListener("resize",y),y(),z(a,r)}
