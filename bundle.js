var O=Symbol("Comlink.proxy"),G=Symbol("Comlink.endpoint"),q=Symbol("Comlink.releaseProxy"),F=Symbol("Comlink.finalizer"),k=Symbol("Comlink.thrown"),H=e=>typeof e=="object"&&e!==null||typeof e=="function",V={canHandle:e=>H(e)&&e[O],serialize(e){let{port1:t,port2:n}=new MessageChannel;return U(e,t),[n,[n]]},deserialize(e){return e.start(),j(e)}},J={canHandle:e=>H(e)&&k in e,serialize({value:e}){let t;return e instanceof Error?t={isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:t={isError:!1,value:e},[t,[]]},deserialize(e){throw e.isError?Object.assign(new Error(e.value.message),e.value):e.value}},_=new Map([["proxy",V],["throw",J]]);function K(e,t){for(let n of e)if(t===n||n==="*"||n instanceof RegExp&&n.test(t))return!0;return!1}function U(e,t=globalThis,n=["*"]){t.addEventListener("message",function a(i){if(!i||!i.data)return;if(!K(n,i.origin)){console.warn(`Invalid origin '${i.origin}' for comlink proxy`);return}let{id:r,type:o,path:c}=Object.assign({path:[]},i.data),s=(i.data.argumentList||[]).map(v),l;try{let d=c.slice(0,-1).reduce((u,y)=>u[y],e),p=c.reduce((u,y)=>u[y],e);switch(o){case"GET":l=p;break;case"SET":d[c.slice(-1)[0]]=v(i.data.value),l=!0;break;case"APPLY":l=p.apply(d,s);break;case"CONSTRUCT":{let u=new p(...s);l=ie(u)}break;case"ENDPOINT":{let{port1:u,port2:y}=new MessageChannel;U(e,y),l=ne(u,[u])}break;case"RELEASE":l=void 0;break;default:return}}catch(d){l={value:d,[k]:0}}Promise.resolve(l).catch(d=>({value:d,[k]:0})).then(d=>{let[p,u]=T(d);t.postMessage(Object.assign(Object.assign({},p),{id:r}),u),o==="RELEASE"&&(t.removeEventListener("message",a),W(t),F in e&&typeof e[F]=="function"&&e[F]())}).catch(d=>{let[p,u]=T({value:new TypeError("Unserializable return value"),[k]:0});t.postMessage(Object.assign(Object.assign({},p),{id:r}),u)})}),t.start&&t.start()}function Q(e){return e.constructor.name==="MessagePort"}function W(e){Q(e)&&e.close()}function j(e,t){return z(e,[],t)}function R(e){if(e)throw new Error("Proxy has been released and is not useable")}function D(e){return b(e,{type:"RELEASE"}).then(()=>{W(e)})}var S=new WeakMap,I="FinalizationRegistry"in globalThis&&new FinalizationRegistry(e=>{let t=(S.get(e)||0)-1;S.set(e,t),t===0&&D(e)});function Z(e,t){let n=(S.get(t)||0)+1;S.set(t,n),I&&I.register(e,t,e)}function ee(e){I&&I.unregister(e)}function z(e,t=[],n=function(){}){let a=!1,i=new Proxy(n,{get(r,o){if(R(a),o===q)return()=>{ee(i),D(e),a=!0};if(o==="then"){if(t.length===0)return{then:()=>i};let c=b(e,{type:"GET",path:t.map(s=>s.toString())}).then(v);return c.then.bind(c)}return z(e,[...t,o])},set(r,o,c){R(a);let[s,l]=T(c);return b(e,{type:"SET",path:[...t,o].map(d=>d.toString()),value:s},l).then(v)},apply(r,o,c){R(a);let s=t[t.length-1];if(s===G)return b(e,{type:"ENDPOINT"}).then(v);if(s==="bind")return z(e,t.slice(0,-1));let[l,d]=P(c);return b(e,{type:"APPLY",path:t.map(p=>p.toString()),argumentList:l},d).then(v)},construct(r,o){R(a);let[c,s]=P(o);return b(e,{type:"CONSTRUCT",path:t.map(l=>l.toString()),argumentList:c},s).then(v)}});return Z(i,e),i}function te(e){return Array.prototype.concat.apply([],e)}function P(e){let t=e.map(T);return[t.map(n=>n[0]),te(t.map(n=>n[1]))]}var Y=new WeakMap;function ne(e,t){return Y.set(e,t),e}function ie(e){return Object.assign(e,{[O]:!0})}function T(e){for(let[t,n]of _)if(n.canHandle(e)){let[a,i]=n.serialize(e);return[{type:"HANDLER",name:t,value:a},i]}return[{type:"RAW",value:e},Y.get(e)||[]]}function v(e){switch(e.type){case"HANDLER":return _.get(e.name).deserialize(e.value);case"RAW":return e.value}}function b(e,t,n){return new Promise(a=>{let i=oe();e.addEventListener("message",function r(o){!o.data||!o.data.id||o.data.id!==i||(e.removeEventListener("message",r),a(o.data))}),e.start&&e.start(),e.postMessage(Object.assign({id:i},t),n)})}function oe(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}var ae=j(new Worker(new URL("./wrk/ffs.js",self.location))),B=(e,t,n)=>ae.findSolution(e,t,n);var A=class{constructor(t=document.body){this.container=t,this.controllers=[],this.hidden=!1}addSlider(t,n,a,i=0,r=100,o=1){let c=this._createUIItem(t),s=document.createElement("input");s.className="slider",s.type="range",s.min=i,s.max=r,s.step=o,s.value=n[a];let l=document.createElement("span");l.textContent=s.value,s.oninput=()=>{n[a]=parseFloat(s.value),l.textContent=s.value},c.appendChild(s),c.appendChild(l),this.container.appendChild(c)}addCheckbox(t,n,a){let i=this._createUIItem(t),r=document.createElement("input");r.type="checkbox",r.checked=n[a],r.onchange=()=>{n[a]=r.checked},i.appendChild(r),this.container.appendChild(i)}addDropdown(t,n,a,i){let r=this._createUIItem(t),o=document.createElement("select");for(let[c,s]of Object.entries(i)){let l=document.createElement("option");l.value=s,l.textContent=c,o.appendChild(l)}o.value=n[a],o.onchange=()=>{n[a]=parseFloat(o.value)},r.appendChild(o),this.container.appendChild(r)}addButton(t,n){let a=this._createUIItem(""),i=document.createElement("button");i.textContent=t,i.className="neumorphic-button",i.onclick=n,a.appendChild(i),this.container.appendChild(a)}addInfo(t,n){let a=this._createUIItem(t),i=document.createElement("div");i.className="info",i.textContent=n,a.appendChild(i),this.container.appendChild(a)}toggleMenu(){this.hidden=!this.hidden,this.container.classList.toggle("hidden",this.hidden)}_createUIItem(t){let n=document.createElement("div");if(n.className="ui-item",t){let a=document.createElement("label");a.textContent=t,n.appendChild(a)}return n}};function re(e){se(),f(1,1),f(4,5),f(3,4),f(4,3),f(3,2),f(2,1),f(2,3),f(3,5),f(1,2),le(e)}var L=[];function se(){let e=document.createElement("input");e.type="file",e.accept="image/*",e.multiple=!0;let t=document.createElement("div");t.innerText="+",t.style.position="absolute",t.style.cursor="pointer",t.style.left="5vw",t.style.top="5vh",t.style.fontSize="4em",document.body.append(t),t.onclick=()=>e.click(),e.onchange=ce}var x=document.createElement("div");x.style.display="flex";x.style.flexWrap="wrap";x.style.marginTop="15vh";document.body.appendChild(x);function ce(e){document.getElementById("uiContainer").style.display="none";let t=e.target.files;Array.from(t).forEach(n=>{let a=new FileReader;a.onload=function(i){let r=document.createElement("img");r.src=i.target.result,r.style.maxWidth="33vw",r.style.maxHeight="33vh",r.style.objectFit="cover",x.appendChild(r),r.onload=o=>{L.push({width:o.target.naturalWidth,height:o.target.naturalHeight,url:r.src})}},a.readAsDataURL(n)})}function f(e,t){let n=e/t,a=document.createElement("div");a.className="card-container";let i=document.createElement("div");i.style.backgroundColor="hsl(0, 0%, 90%)",n<=1?(i.style.width="50px",i.style.height=50/n+"px"):(i.style.height="50px",i.style.width=50*n+"px");let r=0,o=document.createElement("p");o.innerText=`${e}:${t}`,i.append(o);let c=document.createElement("p");c.innerHTML=`amount: <span class='span-amount'> ${r} </span>`,c.style.fontSize="1em",a.append(c),a.append(i),a.addEventListener("click",()=>{r++,c.innerHTML=`amount: <span class='span-amount'> ${r} </span>`,L.push({width:e,height:t,url:""})}),$.append(a)}function le(e){let t=document.createElement("div");t.innerText="run",t.style.position="absolute",t.style.cursor="pointer",t.style.right="10vw",t.style.top="5vh",t.style.fontSize="4em",t.addEventListener("click",()=>{L[0]!==void 0&&(document.querySelector(".menu-wraper").style.display="none",document.body.innerHTML="",e(L))}),document.body.append(t)}function de(e){let t=document.createElement("div");return t.innerText="next",t.style.position="absolute",t.style.cursor="pointer",t.style.right="5vw",t.style.top="5vh",t.style.fontSize="4em",t}function X(e,t){let n=2,a=1,i=document.createElement("div"),r=document.createElement("input");r.className="inputAR",r.value=n,r.oninput=c=>{n=c.target.value};let o=document.createElement("input");o.className="inputAR",o.value=a,o.oninput=c=>{a=c.target.value},button=de(t),button.addEventListener("click",()=>{i.innerHTML="",e.CONTAINER_AR=a/n,re(t)}),i.append(r,o,button),$.append(i)}var $=document.querySelector(".menu-container");function ue(e,t,n){return{dimension:{width:e,height:t},aspectRatio:e/t,url:n}}var M={CONTAINER_AR:0};X(M,he);new A(document.getElementById("uiContainer"));function he(e){let t=document.createElement("canvas");t.onclick=()=>{u(i,r)},document.body.append(t);let n=10,a=10,i=0,r=0,o={width:0,height:0},c=[],s=t.getContext("2d"),l=e.map(m=>ue(m.width,m.height,m.url)).sort((m,w)=>m.aspectRatio-w.aspectRatio),d={width:0,height:0};function p(){t.width=window.innerWidth,t.height=window.innerHeight,o.width=t.width-n*2,o.height=o.width*M.CONTAINER_AR,o.height>t.height-a*2&&(o.height=t.height-a*2,o.width=o.height/M.CONTAINER_AR),i=(t.width-o.width)/2,r=(t.height-o.height)/2;let m=o.width/d.width,w=o.height/d.height;d.width!==0&&d.height!==0&&(c=c.map(g=>({...g,position:{x:g.position.x*m,y:g.position.y*w},dimension:{width:g.dimension.width*m,height:g.dimension.height*w}}))),d={...o},y(c)}function u(m,w){B(l,o,{randomizeThreshold:1}).then(g=>{c=g.pictures.sort((E,C)=>E.dimension.width/E.dimension.height-C.dimension.width/C.dimension.height),y(c)})}function y(m){let w=0,g=0,E=l[0].aspectRatio,C=E;s.clearRect(0,0,t.width,t.height),s.beginPath(),s.strokeStyle="black",s.strokeRect(i,r,o.width,o.height);for(let h of m){if(s.beginPath(),E=l[w].aspectRatio,E!==C&&(g++,C=E),h.url==="")s.fillStyle="black",s.fillRect(h.position.x+i,h.position.y+r,h.dimension.width,h.dimension.height),s.strokeStyle="white",s.lineWidth=1,s.strokeRect(h.position.x+i,h.position.y+r,h.dimension.width,h.dimension.height);else{let N=new Image;N.src=h.url,N.onload=()=>{s.drawImage(N,h.position.x+i,h.position.y+r,h.dimension.width,h.dimension.height)}}w++}}window.addEventListener("resize",p),p(),u(i,r)}
