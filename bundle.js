var O=Symbol("Comlink.proxy"),G=Symbol("Comlink.endpoint"),q=Symbol("Comlink.releaseProxy"),N=Symbol("Comlink.finalizer"),k=Symbol("Comlink.thrown"),H=e=>typeof e=="object"&&e!==null||typeof e=="function",V={canHandle:e=>H(e)&&e[O],serialize(e){let{port1:t,port2:n}=new MessageChannel;return U(e,t),[n,[n]]},deserialize(e){return e.start(),j(e)}},J={canHandle:e=>H(e)&&k in e,serialize({value:e}){let t;return e instanceof Error?t={isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:t={isError:!1,value:e},[t,[]]},deserialize(e){throw e.isError?Object.assign(new Error(e.value.message),e.value):e.value}},_=new Map([["proxy",V],["throw",J]]);function K(e,t){for(let n of e)if(t===n||n==="*"||n instanceof RegExp&&n.test(t))return!0;return!1}function U(e,t=globalThis,n=["*"]){t.addEventListener("message",function a(o){if(!o||!o.data)return;if(!K(n,o.origin)){console.warn(`Invalid origin '${o.origin}' for comlink proxy`);return}let{id:r,type:i,path:c}=Object.assign({path:[]},o.data),s=(o.data.argumentList||[]).map(v),l;try{let d=c.slice(0,-1).reduce((u,y)=>u[y],e),p=c.reduce((u,y)=>u[y],e);switch(i){case"GET":l=p;break;case"SET":d[c.slice(-1)[0]]=v(o.data.value),l=!0;break;case"APPLY":l=p.apply(d,s);break;case"CONSTRUCT":{let u=new p(...s);l=oe(u)}break;case"ENDPOINT":{let{port1:u,port2:y}=new MessageChannel;U(e,y),l=ne(u,[u])}break;case"RELEASE":l=void 0;break;default:return}}catch(d){l={value:d,[k]:0}}Promise.resolve(l).catch(d=>({value:d,[k]:0})).then(d=>{let[p,u]=I(d);t.postMessage(Object.assign(Object.assign({},p),{id:r}),u),i==="RELEASE"&&(t.removeEventListener("message",a),W(t),N in e&&typeof e[N]=="function"&&e[N]())}).catch(d=>{let[p,u]=I({value:new TypeError("Unserializable return value"),[k]:0});t.postMessage(Object.assign(Object.assign({},p),{id:r}),u)})}),t.start&&t.start()}function Q(e){return e.constructor.name==="MessagePort"}function W(e){Q(e)&&e.close()}function j(e,t){return F(e,[],t)}function R(e){if(e)throw new Error("Proxy has been released and is not useable")}function D(e){return b(e,{type:"RELEASE"}).then(()=>{W(e)})}var M=new WeakMap,S="FinalizationRegistry"in globalThis&&new FinalizationRegistry(e=>{let t=(M.get(e)||0)-1;M.set(e,t),t===0&&D(e)});function Z(e,t){let n=(M.get(t)||0)+1;M.set(t,n),S&&S.register(e,t,e)}function ee(e){S&&S.unregister(e)}function F(e,t=[],n=function(){}){let a=!1,o=new Proxy(n,{get(r,i){if(R(a),i===q)return()=>{ee(o),D(e),a=!0};if(i==="then"){if(t.length===0)return{then:()=>o};let c=b(e,{type:"GET",path:t.map(s=>s.toString())}).then(v);return c.then.bind(c)}return F(e,[...t,i])},set(r,i,c){R(a);let[s,l]=I(c);return b(e,{type:"SET",path:[...t,i].map(d=>d.toString()),value:s},l).then(v)},apply(r,i,c){R(a);let s=t[t.length-1];if(s===G)return b(e,{type:"ENDPOINT"}).then(v);if(s==="bind")return F(e,t.slice(0,-1));let[l,d]=P(c);return b(e,{type:"APPLY",path:t.map(p=>p.toString()),argumentList:l},d).then(v)},construct(r,i){R(a);let[c,s]=P(i);return b(e,{type:"CONSTRUCT",path:t.map(l=>l.toString()),argumentList:c},s).then(v)}});return Z(o,e),o}function te(e){return Array.prototype.concat.apply([],e)}function P(e){let t=e.map(I);return[t.map(n=>n[0]),te(t.map(n=>n[1]))]}var Y=new WeakMap;function ne(e,t){return Y.set(e,t),e}function oe(e){return Object.assign(e,{[O]:!0})}function I(e){for(let[t,n]of _)if(n.canHandle(e)){let[a,o]=n.serialize(e);return[{type:"HANDLER",name:t,value:a},o]}return[{type:"RAW",value:e},Y.get(e)||[]]}function v(e){switch(e.type){case"HANDLER":return _.get(e.name).deserialize(e.value);case"RAW":return e.value}}function b(e,t,n){return new Promise(a=>{let o=ie();e.addEventListener("message",function r(i){!i.data||!i.data.id||i.data.id!==o||(e.removeEventListener("message",r),a(i.data))}),e.start&&e.start(),e.postMessage(Object.assign({id:o},t),n)})}function ie(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}var ae=j(new Worker(new URL("./wrk/ffs.js",self.location))),B=(e,t,n)=>ae.findSolution(e,t,n);var T=class{constructor(t=document.body){this.container=t,this.controllers=[],this.hidden=!1}addSlider(t,n,a,o=0,r=100,i=1){let c=this._createUIItem(t),s=document.createElement("input");s.className="slider",s.type="range",s.min=o,s.max=r,s.step=i,s.value=n[a];let l=document.createElement("span");l.textContent=s.value,s.oninput=()=>{n[a]=parseFloat(s.value),l.textContent=s.value},c.appendChild(s),c.appendChild(l),this.container.appendChild(c)}addCheckbox(t,n,a){let o=this._createUIItem(t),r=document.createElement("input");r.type="checkbox",r.checked=n[a],r.onchange=()=>{n[a]=r.checked},o.appendChild(r),this.container.appendChild(o)}addDropdown(t,n,a,o){let r=this._createUIItem(t),i=document.createElement("select");for(let[c,s]of Object.entries(o)){let l=document.createElement("option");l.value=s,l.textContent=c,i.appendChild(l)}i.value=n[a],i.onchange=()=>{n[a]=parseFloat(i.value)},r.appendChild(i),this.container.appendChild(r)}addButton(t,n){let a=this._createUIItem(""),o=document.createElement("button");o.textContent=t,o.className="neumorphic-button",o.onclick=n,a.appendChild(o),this.container.appendChild(a)}addInfo(t,n){let a=this._createUIItem(t),o=document.createElement("div");o.className="info",o.textContent=n,a.appendChild(o),this.container.appendChild(a)}toggleMenu(){this.hidden=!this.hidden,this.container.classList.toggle("hidden",this.hidden)}_createUIItem(t){let n=document.createElement("div");if(n.className="ui-item",t){let a=document.createElement("label");a.textContent=t,n.appendChild(a)}return n}};function re(e){se(),f(1,1),f(4,5),f(3,4),f(4,3),f(3,2),f(2,1),f(2,3),f(3,5),f(1,2),le(e)}var A=[];function se(){let e=document.createElement("input");e.type="file",e.accept="image/*",e.multiple=!0;let t=document.createElement("div");t.innerText="+",t.style.position="absolute",t.style.cursor="pointer",t.style.left="5vw",t.style.top="5vh",t.style.fontSize="4em",document.body.append(t),t.onclick=()=>e.click(),e.onchange=ce}var x=document.createElement("div");x.style.display="flex";x.style.flexWrap="wrap";x.style.marginTop="15vh";document.body.appendChild(x);function ce(e){document.getElementById("uiContainer").style.display="none";let t=e.target.files;Array.from(t).forEach(n=>{let a=new FileReader;a.onload=function(o){let r=document.createElement("img");r.src=o.target.result,r.style.maxWidth="33vw",r.style.maxHeight="33vh",r.style.objectFit="cover",x.appendChild(r),r.onload=i=>{A.push({width:i.target.naturalWidth,height:i.target.naturalHeight,url:r.src})}},a.readAsDataURL(n)})}function f(e,t){let n=e/t,a=document.createElement("div");a.className="card-container";let o=document.createElement("div");o.style.backgroundColor="hsl(0, 0%, 90%)",n<=1?(o.style.width="50px",o.style.height=50/n+"px"):(o.style.height="50px",o.style.width=50*n+"px");let r=0,i=document.createElement("p");i.innerText=`${e}:${t}`,o.append(i);let c=document.createElement("p");c.innerHTML=`amount: <span class='span-amount'> ${r} </span>`,c.style.fontSize="1em",a.append(c),a.append(o),a.addEventListener("click",()=>{r++,c.innerHTML=`amount: <span class='span-amount'> ${r} </span>`,A.push({width:e,height:t,url:""})}),$.append(a)}function le(e){let t=document.createElement("div");t.innerText="run",t.style.position="absolute",t.style.cursor="pointer",t.style.right="10vw",t.style.top="5vh",t.style.fontSize="4em",t.addEventListener("click",()=>{A[0]!==void 0&&(document.querySelector(".menu-wraper").style.display="none",document.body.innerHTML="",e(A))}),document.body.append(t)}function de(e){let t=document.createElement("div");return t.innerText="next",t.style.position="absolute",t.style.cursor="pointer",t.style.right="5vw",t.style.top="5vh",t.style.fontSize="4em",t}function X(e,t){let n=2,a=1,o=document.createElement("div"),r=document.createElement("input");r.className="inputAR",r.value=n,r.oninput=c=>{n=c.target.value};let i=document.createElement("input");i.className="inputAR",i.value=a,i.oninput=c=>{a=c.target.value},button=de(t),button.addEventListener("click",()=>{o.innerHTML="",e.CONTAINER_AR=a/n,re(t)}),o.append(r,i,button),$.append(o)}var $=document.querySelector(".menu-container");function ue(e,t,n){return{dimension:{width:e,height:t},aspectRatio:e/t,url:n}}var z={CONTAINER_AR:0};X(z,he);new T(document.getElementById("uiContainer"));function he(e){let t=document.createElement("canvas");t.onclick=()=>{u(o,r)},document.body.append(t);let n=10,a=10,o=0,r=0,i={width:0,height:0},c=[],s=t.getContext("2d"),l=e.map(m=>ue(m.width,m.height,m.url)).sort((m,w)=>m.aspectRatio-w.aspectRatio),d={width:0,height:0};function p(){t.width=window.innerWidth,t.height=window.innerHeight,i.width=t.width-n*2,i.height=i.width*z.CONTAINER_AR,i.height>t.height-a*2&&(i.height=t.height-a*2,i.width=i.height/z.CONTAINER_AR),o=(t.width-i.width)/2,r=(t.height-i.height)/2;let m=i.width/d.width,w=i.height/d.height;d.width!==0&&d.height!==0&&(c=c.map(g=>({...g,position:{x:g.position.x*m,y:g.position.y*w},dimension:{width:g.dimension.width*m,height:g.dimension.height*w}}))),d={...i},y(c)}function u(m,w){B(l,i,{randomizeThreshold:1}).then(g=>{c=g.pictures.sort((E,C)=>E.dimension.width/E.dimension.height-C.dimension.width/C.dimension.height),y(c)})}function y(m){let w=0,g=0,E=l[0].aspectRatio,C=E;s.clearRect(0,0,t.width,t.height),s.beginPath(),s.strokeStyle="black",s.strokeRect(Math.round(o),Math.round(r),Math.round(i.width),Math.round(i.height));for(let h of m){if(s.beginPath(),E=l[w].aspectRatio,E!==C&&(g++,C=E),h.url==="")s.fillStyle="black",s.fillRect(Math.round(h.position.x+o),Math.round(h.position.y+r),Math.round(h.dimension.width),Math.round(h.dimension.height)),s.strokeStyle="white",s.lineWidth=1,s.strokeRect(Math.round(h.position.x+o),Math.round(h.position.y+r),Math.round(h.dimension.width),Math.round(h.dimension.height));else{let L=new Image;L.src=h.url,L.onload=()=>{s.drawImage(L,Math.round(h.position.x+o),Math.round(h.position.y+r),Math.round(h.dimension.width),Math.round(h.dimension.height))}}w++}}window.addEventListener("resize",p),p(),u(o,r)}
